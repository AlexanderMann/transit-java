#!/bin/bash

set -e

echo "Cleaning..."
rm -rf ./target

echo "Calculating version..."
prefix=`cat VERSION_PREFIX`
suffix=`build/revision`
version=$prefix.$suffix
echo $version

echo "Packaging..."
mvn versions:set -DnewVersion=${version}
mvn install
mvn versions:revert

target_name=transit-java-${version}
target_path=./target/${target_name}

cp pom.xml ${target_path}.pom

#echo "Copying LICENSE, README and CHANGES..."
#cp KIT_README.md ${target_path}/README-CONSOLE.md
#cp LICENSE ${target_path}/LICENSE
#cp CHANGES.md ${target_path}/CHANGES.md

echo "Done!"
